<!DOCTYPE html>
   <html lang="en" dir="ltr">
   <head>
     <meta charset="utf-8">
     <title>Weby_byte</title>
     <link rel="stylesheet" href="styles.css">
   </head>
   <body>
     <table cellspacing="20">
       <tr>
         <td><img src="images/Webit.png" alt="Webit Profile Picture" width="150" height="150"></td>
         <td>
           <h1 id="Webit">Webit</h1>
           <p><em>Founder of <strong><a href="https://youtube.com/@Weby_byte">Weby_byte</a></strong></em></p>
           <p>I am a Programmer and a Web Developer. I Love ❤️ Coding and Programming.</p>
         </td>
       </tr>
     </table>
     <hr size="2" noshade>
   
     <h2 id="Code">Code</h2>
     <div class="code-container">
       <p class="code-title">Import:</p>
       <pre class="codetext">
   import pyttsx3
   import speech_recognition as sr
       </pre>
     </div>
   
     <div class="code-container">
       <p class="code-title">Speak Function:</p>
       <pre class="codetext">
   
   engine = pyttsx3.init('sapi5')
   voices = engine.getProperty('voices')
   engine.setProperty('voice', voices[0].id)
   rate = engine.setProperty("rate",185)
   
   def Speak(audio):
     engine.say(audio)
     engine.runAndWait()
       </pre>
     </div>
   
     <div class="code-container">
       <p class="code-title">Take Command Function:</p>
       <pre class="codetext">
   def TakeCommand():
   
     r = sr.Recognizer()
     with sr.Microphone() as source:
         print("Listening...")
         r.pause_threshold = 1
         audio = r.listen(source,0,4)
   
     try:
         print("Understanding...")
         query = r.recognize_google(audio, language='en-in')
         print(f"Master said: {query}\n")
     except Exception as e:
         print("Say that again please...")
         return "None"
     return query
       </pre>
     </div>
     <div class="code-container">
       <pre class="codetext">
  if __name__ == "__main__": 
      while True:
          query = TakeCommand().lower()
          
       </pre>
     </div>
     <div class="code-container">
      <p class="code-title">Greet Me Function:</p>
      <pre class="codetext">
  
    import pyttsx3
    import datetime
    
    # Text to Speech engine.
    engine = pyttsx3.init('sapi5')
    voices = engine.getProperty('voices')
    engine.setProperty('voice', voices[0].id)
    rate = engine.setProperty("rate",185)
    
    def Speak(audio):
        engine.say(audio)
        engine.runAndWait()
    
    # Greet when the program started.
    def greetme():
        hour = int(datetime.datetime.now().hour)
        if hour >=0 and hour<=12:
            Speak("Good Morning, Sir!")
        elif hour >=12 and hour<=18:
            Speak("Good Afternoon, Sir!")
        else:
            Speak("Good Evening, Sir")
    
        Speak("I am Jarvis. How can I help you Sir!")
    
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">Hotward Function:</p>
      <pre class="codetext">
    if "wake up" in query:
    from Greetme import greetme
    greetme()

    while True:
        query = TakeCommand().lower()

        if "go to sleep" in query:
            Speak("Ok Sir, you can call me anytime")
            break
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">Time Function:</p>
      <pre class="codetext">
        elif 'time' in query:
        strTime = datetime.datetime.now().strftime("%H:%M:%S")    
        print(f"Sir, the time is {strTime}") 
        Speak(f"Sir, the time is {strTime}")
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">internet speeed:</p>
      <pre class="codetext">
        elif "internet speed" in query:
        wifi  = speedtest.Speedtest()
        upload_net = wifi.upload()/1048576         #Megabyte = 1024*1024 Bytes
        download_net = wifi.download()/1048576
        print("Wifi Upload Speed is", upload_net)
        print("Wifi download speed is ",download_net)
        Speak(f"Wifi download speed is {download_net}")
        Speak(f"Wifi Upload speed is {upload_net}")
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">Calculate Numbers:</p>
      <pre class="codetext">
        elif "calculate" in query:
            from Calculatenumbers import WolfRamAlpha
            from Calculatenumbers import Calculate
            query = query.replace("calculate","")
            query = query.replace("jarvis","")
            Calculate(query)
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">Calculatenumbers.py:</p>
      <pre class="codetext">
      import pyttsx3
      import wolframalpha
            
      # Text to Speech engine.
      engine = pyttsx3.init('sapi5')
      voices = engine.getProperty('voices')
      engine.setProperty('voice', voices[0].id)
      rate = engine.setProperty("rate",185)
            
      def Speak(audio):
          engine.say(audio)
          engine.runAndWait()
            
      def WolfRamAlpha(query):
          apikey = "WGKT3V-R88U56Q4T6"
          requester = wolframalpha.Client(apikey)
          requested = requester.query(query)
            
          try:
              answer = next(requested.results).text
              return answer
          except:
              Speak("The value is not answerable")
            
      def Calculate(query):
          Term = str(query)
          Term = Term.replace("jarvis","")
          Term = Term.replace("multiply","*")
          Term = Term.replace("plus","+")
          Term = Term.replace("minus","-")
          Term = Term.replace("divide","/")
            
          Final = str(Term)
            
          try:
              result = WolfRamAlpha(Final)
              print(f"{result}")
              Speak(result)
            
          except:
              Speak("The value is not answerable")
            
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">Email Function:</p>
      <pre class="codetext">
        elif "write an email" in query:
        print("To whom do you wnat to send the email")
        Speak("To whom do you wnat to send the email")

        recipient_name = TakeCommand().lower()
        from sendemail import recipient_mapping
        recipient_email = recipient_mapping.get(recipient_name)

        if recipient_email:
            print("what the subject of the email?")
            Speak("what the subject of the email?")

            subject = TakeCommand().lower()
            from sendemail import send_email
            from sendemail import sender_email
            from sendemail import sender_password

            print("what is the message of the email")
            Speak("what is the message of the email")
            content = TakeCommand().lower()

            send_email(sender_email, sender_password, recipient_email, subject, content)

        else:
            print('Sorry! I am not able to find your address details')
            Speak('Sorry! I am not able to find your address details.')
            
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">sendemail.py:</p>
      <pre class="codetext">

        elif "ip address" in query:
        ip = get('https://api.ipify.org').text
        print(f"Your ip address is {ip}")
        Speak(f"Your ip address is {ip}")
      </pre>
    </div>
    <div class="code-container">
      <p class="code-title">IP address:</p>
      <pre class="codetext">
        elif "temperature" in query:
        search = "temperature in rajasthan"
        url = f"https://www.google.com/search?q={search}" 
        r = requests.get(url)
        data = BeautifulSoup(r.text,"html.parser")
        temp = data.find("div", class_ = "BNeawe").text
        Speak(f"current{search} is {temp}")

      </pre>
    </div>
  
  
   </body>
   </html>
   
  </head>
